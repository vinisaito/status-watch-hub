const initialStateRequestedRef = useRef(false);

useEffect(() => {
  if (!isConnected || initialStateRequestedRef.current) return;

  try {
    const currentKeys = Array.from(timers.keys());
    const watchedKeys = Array.from(watchedChamadosRef.current);
    const uniqueChamados = Array.from(new Set([...currentKeys, ...watchedKeys]));

    if (uniqueChamados.length === 0) return;

    console.log('üîÅ Solicitando estado inicial para chamados:', uniqueChamados);
    uniqueChamados.forEach(chamado => {
      try {
        getState(chamado);
      } catch (err) {
        console.error(`Erro ao solicitar getState para ${chamado}:`, err);
      }
    });

    // Marca que j√° solicitou o estado inicial
    initialStateRequestedRef.current = true;

  } catch (err) {
    console.error('Erro no efeito de sincroniza√ß√£o inicial:', err);
  }
}, [isConnected, getState, timers]);
