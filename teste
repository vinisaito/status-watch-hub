socket.onmessage = (event) => {
  if (!event.data) {
    console.warn("[WS] âš ï¸ Mensagem vazia ignorada");
    return;
  }

  try {
    const data = JSON.parse(event.data);

    if (!data || typeof data !== "object") {
      console.warn("[WS] âš ï¸ Payload nÃ£o Ã© um objeto:", event.data);
      return;
    }

    if (!("chamado" in data)) {
      console.warn("[WS] âš ï¸ Mensagem recebida sem 'chamado':", data);
      return;
    }

    // ğŸ‘‰ sÃ³ aqui processa de fato
    handleChamadoUpdate(data);

  } catch (err) {
    console.error(
      "[WS] âŒ Erro ao processar mensagem:",
      err,
      "RAW:",
      event.data
    );
  }
};
