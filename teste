socket.onmessage = (event) => {
  try {
    if (!event.data || event.data.trim() === "") {
      console.warn("[WS] ⚠️ Mensagem vazia ignorada");
      return;
    }

    const msg = JSON.parse(event.data);

    if (!msg.chamado && !msg.action) {
      console.warn("[WS] ⚠️ Mensagem recebida sem 'chamado':", msg);
      return;
    }

    console.log("[WS] ✅ Mensagem recebida:", msg);

    // aqui você trata suas mensagens normalmente...
    handleMessage(msg);

  } catch (err) {
    console.error("[WS] ❌ Erro ao processar mensagem:", err);
  }
};
