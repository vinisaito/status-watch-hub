ws.current.onmessage = (event) => {
  try {
    const message: WebSocketMessage = JSON.parse(event.data);

    if (message.state && message.chamado) {
      setTimers(prev => {
        const oldState = prev.get(message.chamado);
        const isDifferent = JSON.stringify(oldState) !== JSON.stringify(message.state);

        // SÃ³ loga se houver diferenÃ§a real
        if (isDifferent) {
          console.log(`ğŸ”” Novo evento para chamado ${message.chamado}`, message.state);
          const newTimers = new Map(prev);
          newTimers.set(message.chamado, message.state!);
          return newTimers;
        }

        // Retorna o state antigo se nada mudou
        return prev;
      });
    }
  } catch (error) {
    console.error('âŒ Erro ao processar mensagem WebSocket:', error);
  }
};
