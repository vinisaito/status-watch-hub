import React, { useEffect, useState } from "react";
import Timer from "./Timer";

const App: React.FC = () => {
  const [ws, setWs] = useState<WebSocket | null>(null);
  const chamado = 10418007; // exemplo
  const apiBaseUrl = "https://f6ffk8e9fe.execute-api.us-east-1.amazonaws.com/prod";

  useEffect(() => {
    const socket = new WebSocket("wss://tgwtw1v4rg.execute-api.us-east-1.amazonaws.com/dev");
    
    socket.onopen = () => {
      console.log("✅ WebSocket conectado");
    };

    socket.onclose = () => {
      console.log("❌ WebSocket desconectado");
    };

    setWs(socket);

    return () => {
      socket.close();
    };
  }, []);

  if (!ws) return <div>Conectando WebSocket...</div>;

  return (
    <div>
      <h1>Painel de Alertas</h1>
      <Timer chamado={chamado} ws={ws} apiBaseUrl={apiBaseUrl} />
    </div>
  );
};

export default App;
