df = (
    spark.read.format("jdbc")
    .option("url", jdbc_url)
    .option("dbtable", f"({query})")
    .option("user", db_user)
    .option("password", db_password)
    .option("driver", "com.microsoft.sqlserver.jdbc.SQLServerDriver")
    .option("fetchsize", "10000")
    .load()
)
