def _save_to_dynamo(items):
    """Registra ou atualiza chamados no DynamoDB com num_chamado como PartitionKey (Number)."""
    if not items:
        print("‚ö†Ô∏è Nenhum item para registrar no DynamoDB.")
        return

    # Se o mesmo num_chamado aparecer mais de uma vez, mant√©m o √∫ltimo (mais recente)
    unicos = {}
    for item in items:
        num = item.get("num_chamado")
        if num is None:
            print(f"‚ö†Ô∏è Item ignorado (sem num_chamado): {item}")
            continue
        unicos[num] = item  # substitui se repetido

    print(f"üß© {len(unicos)} chamados √∫nicos (prontos para upsert no DynamoDB)")

    with table.batch_writer(overwrite_by_pkeys=["num_chamado"]) as batch:
        for item in unicos.values():
            try:
                # Converte num_chamado explicitamente para Number (Decimal)
                item["num_chamado"] = Decimal(str(int(item["num_chamado"])))

                # Adiciona timestamp de atualiza√ß√£o
                item["updated_at"] = datetime.utcnow().isoformat()

                batch.put_item(Item=item)
            except Exception as e:
                print(f"‚ùå Erro ao gravar item no DynamoDB: {e}")
